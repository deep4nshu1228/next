WITH t1 AS (
SELECT X_DEALER_CODE, District,
ROW_NUMBER() OVER (PARTITION BY X_DEALER_CODE ORDER BY CASE WHEN District IS NULL THEN 1 ELSE 0 END, some_tiebreaker) AS rn
FROM table1
)
SELECT t0.DEALER_CODE, t1.District
FROM t0
LEFT JOIN t1
ON t1.X_DEALER_CODE = t0.DEALER_CODE
WHERE t1.rn = 1;
