import pandas as pd

# df = pd.read_csv('cleaned.csv')

# Ensure dtypes
df["WARRANTY_CLAIM_DATE"] = pd.to_datetime(df["WARRANTY_CLAIM_DATE"], errors="coerce")
df["WARRANTY_COST"] = pd.to_numeric(df["WARRANTY_COST"], errors="coerce")

# Derive month period and a label
df["warranty_month"] = df["WARRANTY_CLAIM_DATE"].dt.to_period("M")

cost_by_warranty_month = (
    df.groupby("warranty_month")["WARRANTY_COST"]
      .sum(min_count=1)
      .reset_index(name="total_warranty_cost")
      .sort_values("warranty_month")
)

# Optional: add mm-YYYY string label
cost_by_warranty_month["warranty_month_str"] = cost_by_warranty_month["warranty_month"].dt.strftime("%m-%Y")

# Save
cost_by_warranty_month.to_csv("warranty_cost_by_warranty_month.csv", index=False)
cost_by_warranty_month.head()
