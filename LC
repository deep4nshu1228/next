import pandas as pd

# Read input Excel
df = pd.read_excel("input.xlsx")   # update filename if needed

# Rename BIKE_GROUPED -> BIKE_FAMILY
df = df.rename(columns={
    "BIKE_GROUPED": "BIKE_FAMILY",
    "WARRANTY_MONTH": "WARRANTY_MONTHF"
})

# Create WARRANTY_COST_PER_UNIT
df["WARRANTY_COST_PER_UNIT"] = df["WARRANTY_COST"] / df["VOLUME"]

# Create INCOMPLETE_COMPLETE_WARRANTY
df["INCOMPLETE_COMPLETE_WARRANTY"] = df["WARRANTY_COST_TYPE"].map(
    {
        "Actual": "COMPLETE",
        "PREDICTED": "INCOMPLETE"
    }
)

# Select final required columns in order
final_df = df[
    [
        "BIKE_FAMILY",
        "DISPATCH_MONTH",
        "WARRANTY_MONTHF",
        "AGE",
        "VOLUME",
        "WARRANTY_COST",
        "WARRANTY_COST_PER_UNIT",
        "INCOMPLETE_COMPLETE_WARRANTY"
    ]
]

# Write to new Excel file
final_df.to_excel("output.xlsx", index=False)
